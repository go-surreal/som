// Code generated by github.com/go-surreal/som, DO NOT EDIT.
package conv

import (
	v2 "github.com/fxamacker/cbor/v2"
	som "github.com/go-surreal/som/tests/basic/gen/som"
	cbor "github.com/go-surreal/som/tests/basic/gen/som/internal/cbor"
	model "github.com/go-surreal/som/tests/basic/model"
)

type URLExample struct {
	model.URLExample
}

func (c *URLExample) MarshalCBOR() ([]byte, error) {
	if c == nil {
		return cbor.Marshal(nil)
	}
	data := make(map[string]any, 5)

	// Embedded som.Node/Edge ID field
	if c.ID() != nil {
		data["id"] = c.ID()
	}

	data["provider"] = c.Provider
	data["account"] = c.Account
	if c.SomeURL != nil {
		data["some_url"] = fromURLPtr(c.SomeURL)
	}
	data["some_other_url"] = fromURL(c.SomeOtherURL)

	return cbor.Marshal(data)
}

func (c *URLExample) UnmarshalCBOR(data []byte) error {
	var rawMap map[string]v2.RawMessage
	if err := cbor.Unmarshal(data, &rawMap); err != nil {
		return err
	}

	// Embedded som.Node/Edge ID field
	if raw, ok := rawMap["id"]; ok {
		var id *som.ID
		cbor.Unmarshal(raw, &id)
		c.Node = som.NewNode(id)
	}

	if raw, ok := rawMap["provider"]; ok {
		cbor.Unmarshal(raw, &c.Provider)
	}
	if raw, ok := rawMap["account"]; ok {
		cbor.Unmarshal(raw, &c.Account)
	}
	if raw, ok := rawMap["some_url"]; ok {
		var convVal *string
		cbor.Unmarshal(raw, &convVal)
		c.SomeURL = toURLPtr(convVal)
	}
	if raw, ok := rawMap["some_other_url"]; ok {
		var convVal string
		cbor.Unmarshal(raw, &convVal)
		c.SomeOtherURL = toURL(convVal)
	}

	return nil
}

func FromURLExample(data model.URLExample) URLExample {
	return URLExample{URLExample: data}
}
func FromURLExamplePtr(data *model.URLExample) *URLExample {
	if data == nil {
		return nil
	}
	return &URLExample{URLExample: *data}
}

func ToURLExample(data URLExample) model.URLExample {
	return data.URLExample
}
func ToURLExamplePtr(data *URLExample) *model.URLExample {
	if data == nil {
		return nil
	}
	result := data.URLExample
	return &result
}

type urlexampleLink struct {
	URLExample
	ID *som.ID
}

func (f *urlexampleLink) MarshalCBOR() ([]byte, error) {
	if f == nil {
		return nil, nil
	}
	return cbor.Marshal(f.ID)
}

func (f *urlexampleLink) UnmarshalCBOR(data []byte) error {
	if err := cbor.Unmarshal(data, &f.ID); err == nil {
		return nil
	}
	type alias urlexampleLink
	var link alias
	err := cbor.Unmarshal(data, &link)
	if err == nil {
		*f = urlexampleLink(link)
	}
	return err
}

func fromURLExampleLink(link *urlexampleLink) model.URLExample {
	if link == nil {
		return model.URLExample{}
	}
	res := URLExample(link.URLExample)
	return ToURLExample(res)
}

func fromURLExampleLinkPtr(link *urlexampleLink) *model.URLExample {
	if link == nil {
		return nil
	}
	res := URLExample(link.URLExample)
	out := ToURLExample(res)
	return &out
}

func toURLExampleLink(node model.URLExample) *urlexampleLink {
	if node.ID() == nil {
		return nil
	}
	link := urlexampleLink{URLExample: FromURLExample(node), ID: node.ID()}
	return &link
}

func toURLExampleLinkPtr(node *model.URLExample) *urlexampleLink {
	if node == nil || node.ID() == nil {
		return nil
	}
	link := urlexampleLink{URLExample: FromURLExample(*node), ID: node.ID()}
	return &link
}
